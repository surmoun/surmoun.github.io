<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>ã€STM32ã€‘STM32çš„è€äººå¥åº·åŠè·Œå€’æ£€æµ‹ç³»ç»Ÿ</title>
      <link href="/posts/2024/2536639252.html"/>
      <url>/posts/2024/2536639252.html</url>
      
        <content type="html"><![CDATA[<h2 id="ç³»ç»ŸåŠŸèƒ½"><a href="#ç³»ç»ŸåŠŸèƒ½" class="headerlink" title="ç³»ç»ŸåŠŸèƒ½"></a>ç³»ç»ŸåŠŸèƒ½</h2><p>1.èƒ½å®æ—¶æ£€æµ‹è€äººçš„å¿ƒç‡è¡€æ°§ï¼Œè¡€å‹ï¼Œä½“æ¸©ï¼Œèº«ä½“å§¿æ€ã€‚<br>2.èƒ½é€šè¿‡GPSå®šä½å®æ—¶å®šä½è·å–è€äººæ‰€åœ¨çš„ç»çº¬åº¦ã€‚<br>3.æ•°æ®å®æ—¶ä¸Šä¼ é˜¿é‡Œäº‘é€šè¿‡äº‘æµè½¬ä¼ è¾“åˆ°android APPç•Œé¢ä¸Šã€‚<br>4.å½“è€äººå¿ƒç‡è¡€æ°§ï¼Œè¡€å‹ï¼Œä½“æ¸©å¼‚å¸¸æ—¶è®¾å¤‡ä¼šè¿›è¡Œè¯­éŸ³æŠ¥è­¦ï¼Œå¹¶å°†å¼‚å¸¸æ•°æ®ä¼ è¾“åˆ°æ‰‹æœºAPPä¸Šï¼Œæ‰‹æœºæ”¶åˆ°å¼‚å¸¸æ•°æ®ä¼šå‘å‡ºéœ‡åŠ¨ä»¥åŠé“ƒå“ã€‚<br>5.å½“è€äººå‘ç”Ÿæ‘”å€’æ—¶ï¼Œè®¾å¤‡ä¼šå¤§çº¦15ç§’çš„æ—¶é—´æŠ¥è­¦(èœ‚é¸£å™¨å“å’Œè¯­éŸ³æ’­æŠ¥)ï¼Œå¦‚è€äººèº«ä½“æ— ç¢ï¼Œåˆ™å¯ä»¥è¿›è¡ŒæŒ‰é”®å–æ¶ˆæŠ¥è­¦ï¼›åŒæ—¶è€äººåœ¨éœ€è¦æ—¶å¯ä»¥é€šè¿‡æ‰‹åŠ¨æŠ¥è­¦æŒ‰é”®è¿›è¡ŒæŠ¥è­¦æ±‚åŠ©ï¼Œæ‰‹æœºAPPä¼šæ”¶åˆ°è€äººæ‘”å€’ä»¥åŠæ±‚åŠ©çš„ä¿¡æ¯ã€‚<br>6.è®¾å¤‡å¸¦OLEDæ˜¾ç¤ºå™¨å¯æ˜¾ç¤ºè€äººçš„èº«ä½“æƒ…å†µä¿¡æ¯ï¼›æ‰‹æœºAPPé™„å¸¦åœ°å›¾æ˜¾ç¤ºè€äººçš„å®æ—¶ä½ç½®<br>7.æ‰‹æœºAPPå¯è®¾ç½®è€äººèº«ä½“æ•°æ®å¼‚å¸¸çš„é˜ˆå€¼ã€‚</p><p><img src="https://s21.ax1x.com/2024/07/27/pkqEBVJ.png" alt="ç¡¬ä»¶å›¾"></p><h2 id="ç³»ç»Ÿæ¦‚è¿°"><a href="#ç³»ç»Ÿæ¦‚è¿°" class="headerlink" title="ç³»ç»Ÿæ¦‚è¿°"></a>ç³»ç»Ÿæ¦‚è¿°</h2><p>æœ¬ç³»ç»Ÿä»¥Cè¯­è¨€ä¸ºå¼€å‘è¯­è¨€ï¼ŒåŸºäºSTM32æ ‡å‡†åº“è®¾è®¡ä¸å®ç°äº†ä¸€ç§è€å¹´äººäººèº«å®‰å…¨ç›‘æŠ¤ç³»ç»Ÿã€‚æœ¬ç³»ç»Ÿä¸»è¦åŒ…å«ä¸ƒä¸ªåŠŸèƒ½æ¨¡å—ï¼Œåˆ†åˆ«æ˜¯ï¼šå¿ƒç‡è¡€æ°§ç›‘æµ‹ã€è·Œå€’ç›‘æµ‹ã€è¡€å‹ç›‘æµ‹ã€çº¢å¤–ä½“æ¸©ç›‘æµ‹ã€GPSå®šä½ã€æ˜¾ç¤ºå’Œæ•°æ®ä¼ è¾“ã€‚æœ¬ç³»ç»Ÿé¦–å…ˆä½¿ç”¨ä¼ æ„Ÿå™¨è¿›è¡Œè¡€å‹ç­‰æ•°æ®çš„ç›‘æµ‹ï¼ŒGPSè·å–å®šä½ä¿¡æ¯ï¼Œå±å¹•æ˜¾ç¤ºè€äººçš„çŠ¶æ€ï¼Œç„¶åç³»ç»Ÿé€šè¿‡WIFIè¿æ¥ï¼Œè¿›è¡Œæ•°æ®ä¼ è¾“ï¼Œé€šè¿‡æ‰‹æœºAPPæŸ¥çœ‹çŠ¶æ€ã€‚è¯¥ç³»ç»Ÿçš„å®ç°ï¼Œä¸ä»…èƒ½å¤ŸåŠæ—¶å‘ç°è€å¹´äººèº«ä½“çŠ¶å†µå¼‚å¸¸ï¼Œæé«˜è€å¹´äººçš„äººèº«å®‰å…¨æ€§ï¼Œé¿å…æ„å¤–äº‹ä»¶çš„å‘ç”Ÿï¼Œè€Œä¸”ä»¥ç‰©è”ç½‘+å¥åº·ä¸ºæ ¸å¿ƒçš„æ™ºæ…§ç›‘æµ‹æ¨¡å¼æœ‰æœ›å¾—åˆ°å¹¿æ³›æ¨å¹¿å’Œåº”ç”¨ï¼Œä¸ºè€å¹´äººå¸¦æ¥æ›´é«˜è´¨é‡æ›´å®‰å…¨çš„æ™šå¹´ç”Ÿæ´»ä¿éšœã€‚</p><h2 id="ç³»ç»ŸåŠŸèƒ½åˆ†æ"><a href="#ç³»ç»ŸåŠŸèƒ½åˆ†æ" class="headerlink" title="ç³»ç»ŸåŠŸèƒ½åˆ†æ"></a>ç³»ç»ŸåŠŸèƒ½åˆ†æ</h2><p><img src="https://s21.ax1x.com/2024/07/27/pkqE3Us.png" alt="ç³»ç»Ÿæ¶æ„å›¾"></p><p>æœ¬ç³»ç»Ÿä¸»è¦çš„åŠŸèƒ½åŒ…æ‹¬ä»¥ä¸‹7ç§åŠŸèƒ½æ¨¡å—ã€‚</p><p>ï¼ˆ1ï¼‰å¿ƒç‡è¡€æ°§ç›‘æµ‹æ¨¡å—ï¼šä»¥MAX30102ä¸ºæ ¸å¿ƒï¼Œç”¨æ¥ç›‘æ§è€å¹´äººçš„å¿ƒè·³å’Œè„‰æã€‚</p><p>ï¼ˆ2ï¼‰è·Œå€’ç›‘æµ‹æ¨¡å—ï¼šåˆ©ç”¨MPU6050çš„åŠ é€Ÿåº¦åŠè§’åº¦é€Ÿç‡å¯¹æ‘”å€’è¿›è¡Œåˆ¤å®šã€‚</p><p>ï¼ˆ3ï¼‰è¡€å‹ç›‘æµ‹æ¨¡å—ï¼šç”¨MSP20è¿›è¡Œè¡€å‹çš„ç›‘æµ‹ã€‚</p><p>ï¼ˆ4ï¼‰çº¢å¤–æµ‹æ¸©æ¨¡å—ï¼šä¸»è¦é€šè¿‡GY-906-DAAè¿›è¡Œæµ‹æ¸©ã€‚</p><p>ï¼ˆ5ï¼‰GPSæ¨¡å—ï¼šé€šè¿‡ä¸²å£æ¥æ”¶åˆ°ATGM336Hï¼ˆGPSï¼‰çš„æ•°æ®ã€‚</p><p>ï¼ˆ6ï¼‰æ˜¾ç¤ºæ¨¡å—ï¼šç›´è§‚æ˜¾ç¤ºè€å¹´äººçš„èº«ä½“çŠ¶å†µï¼Œæ˜¯å¦è·Œå€’çš„çŠ¶æ€ã€‚</p><p>ï¼ˆ7ï¼‰æ•°æ®ä¼ è¾“æ¨¡å—ï¼šé€šè¿‡ESP8266æ¨¡å—å®ç°ç½‘ç»œçš„äº’è”ã€‚</p><h3 id="å¿ƒç‡è¡€æ°§åŠŸèƒ½åˆ†æ"><a href="#å¿ƒç‡è¡€æ°§åŠŸèƒ½åˆ†æ" class="headerlink" title="å¿ƒç‡è¡€æ°§åŠŸèƒ½åˆ†æ"></a>å¿ƒç‡è¡€æ°§åŠŸèƒ½åˆ†æ</h3><p>åœ¨æœ¬ç³»ç»Ÿä¸­é€šè¿‡MAX30102å¿ƒç‡è¡€æ°§ä¼ æ„Ÿå™¨å½“æ‰‹æŒ‡æ”¾åˆ°èŠ¯ç‰‡ä¸Šï¼Œè¿›è¡Œè·å–å¿ƒç‡å’Œè¡€æ°§çš„æ•°æ®ï¼Œä¼ é€åˆ°STM32è¿›è¡Œå¤„ç†ã€‚</p><h3 id="è·Œå€’ç›‘æµ‹åŠŸèƒ½åˆ†æ"><a href="#è·Œå€’ç›‘æµ‹åŠŸèƒ½åˆ†æ" class="headerlink" title="è·Œå€’ç›‘æµ‹åŠŸèƒ½åˆ†æ"></a>è·Œå€’ç›‘æµ‹åŠŸèƒ½åˆ†æ</h3><p>ç³»ç»Ÿä½¿ç”¨MPU-6050ä¼ æ„Ÿå™¨åˆ¤æ–­è€äººæ˜¯å¦å‘ç”Ÿè·Œå€’ã€‚è¯¥ä¼ æ„Ÿå™¨èƒ½å¤Ÿæ£€æµ‹è€äººçš„èº«ä½“å§¿åŠ¿å’Œè¿åŠ¨çŠ¶æ€ï¼Œå½“æ£€æµ‹åˆ°å¼‚å¸¸çš„åŠ é€Ÿåº¦å˜åŒ–æ¨¡å¼æ—¶ï¼Œåˆ¤å®šä¸ºå¯èƒ½å‘ç”Ÿè·Œå€’ï¼Œå¹¶è§¦å‘ç›¸åº”çš„æŠ¥è­¦æœºåˆ¶ï¼Œä»¥ä¾¿åŠæ—¶æä¾›æ´åŠ©ã€‚</p><h3 id="è¡€å‹ä¼ æ„Ÿå™¨æ¨¡å—åˆ†æ"><a href="#è¡€å‹ä¼ æ„Ÿå™¨æ¨¡å—åˆ†æ" class="headerlink" title="è¡€å‹ä¼ æ„Ÿå™¨æ¨¡å—åˆ†æ"></a>è¡€å‹ä¼ æ„Ÿå™¨æ¨¡å—åˆ†æ</h3><p>ç³»ç»Ÿé‡‡ç”¨äº†MSP20è¡€å‹ä¼ æ„Ÿå™¨ï¼Œé€šè¿‡æ¨¡æ•°è½¬æ¢ï¼ˆADCï¼‰æŠ€æœ¯æ¥è¯»å–æ•°æ®ã€‚ç„¶åå°†é‡‡é›†åˆ°çš„ä¿¡æ¯å‘é€ç»™STM32å•ç‰‡æœºï¼Œå¹¶å¯¹å…¶è¿›è¡Œå¹³å‡å¤„ç†ã€‚ä»¥è·å¾—æ›´ä¸ºå‡†ç¡®çš„ç”µå‹å€¼ã€‚ç„¶åï¼Œå°†å¾—åˆ°çš„å¹³å‡ç”µå‹å€¼è¿›è¡Œæ”¾å¤§å¤„ç†ï¼Œå†ç»è¿‡è®¡ç®—è¿‡ç¨‹ï¼Œæœ€ç»ˆå¾—åˆ°ç²¾ç¡®çš„è¡€å‹å€¼ã€‚</p><h3 id="çº¢å¤–æµ‹æ¸©æ¨¡å—åŠŸèƒ½åˆ†æ"><a href="#çº¢å¤–æµ‹æ¸©æ¨¡å—åŠŸèƒ½åˆ†æ" class="headerlink" title="çº¢å¤–æµ‹æ¸©æ¨¡å—åŠŸèƒ½åˆ†æ"></a>çº¢å¤–æµ‹æ¸©æ¨¡å—åŠŸèƒ½åˆ†æ</h3><p>è¯¥æ¨¡å—é‡‡ç”¨GY-906-DAAå‹çº¢å¤–çº¿æµ‹æ¸©è£…ç½®å¯¹ä½¿ç”¨è€…çš„èº«ä½“æ¸©åº¦è¿›è¡Œç›‘æµ‹ï¼Œå¹¶å°†æµ‹é‡ç»“æœä¼ é€è‡³STM32å•ç‰‡æœºè¿›è¡Œåˆ†æã€‚</p><h3 id="GPSå®šä½æ¨¡å—åˆ†æ"><a href="#GPSå®šä½æ¨¡å—åˆ†æ" class="headerlink" title="GPSå®šä½æ¨¡å—åˆ†æ"></a>GPSå®šä½æ¨¡å—åˆ†æ</h3><p>ç³»ç»Ÿé€šè¿‡ATGM336Hä¼ æ„Ÿå™¨ä½¿ç”¨ä¸²å£å‘é€å®šä½ä¿¡æ¯åˆ°STM32ï¼Œå°†æ‰€è·å¾—çš„æ—¶é—´è¿›è¡Œåˆ†æã€åˆ†æï¼Œå¹¶å°†å…¶è½¬æ¢ä¸ºæ‰€éœ€è¦çš„æ•°æ®ã€‚ä¼ é€ç»™äº‘å¹³å°è¿›è¡Œåœ°å›¾æ˜¾ç¤ºã€‚</p><h3 id="æ˜¾ç¤ºæ¨¡å—åŠŸèƒ½åˆ†æ"><a href="#æ˜¾ç¤ºæ¨¡å—åŠŸèƒ½åˆ†æ" class="headerlink" title="æ˜¾ç¤ºæ¨¡å—åŠŸèƒ½åˆ†æ"></a>æ˜¾ç¤ºæ¨¡å—åŠŸèƒ½åˆ†æ</h3><p>æ˜¾ç¤ºæ¨¡å—éœ€è¦å¯¹è€å¹´äººå½“å‰çš„äººèº«çŠ¶æ€ï¼Œå¥åº·æƒ…å†µçš„ç›‘æµ‹æ•°æ®è¿›è¡Œæ˜¾ç¤ºï¼Œç³»ç»Ÿé€šè¿‡IICé€šä¿¡å°†æ•°æ®æ˜¾ç¤ºåˆ°OLEDå±å¹•ï¼Œæ›´ç›´è§‚çœ‹å‡ºå„é¡¹æ•°æ®ä»¥åŠçŠ¶æ€ã€‚</p><h3 id="æ•°æ®ä¼ è¾“åŠŸèƒ½åˆ†æ"><a href="#æ•°æ®ä¼ è¾“åŠŸèƒ½åˆ†æ" class="headerlink" title="æ•°æ®ä¼ è¾“åŠŸèƒ½åˆ†æ"></a>æ•°æ®ä¼ è¾“åŠŸèƒ½åˆ†æ</h3><p>ç³»ç»Ÿä½¿ç”¨ESP8266ä¸é˜¿é‡Œäº‘å¹³å°è¿›è¡Œæ•°æ®ä¼ è¾“ï¼ŒAPPç«¯è¿›è¡Œä¸Šä¼ çš„æ•°æ®çš„æ˜¾ç¤ºï¼Œä»¥åŠæŠ¥è­¦çš„é€šçŸ¥æ˜¾ç¤ºã€‚</p><p><img src="https://s21.ax1x.com/2024/07/27/pkqEJCq.png" alt="æ‰‹æœºAPP"></p><p><img src="https://s21.ax1x.com/2024/07/27/pkqEt2V.png" alt="é˜¿é‡Œäº‘å¹³å°"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>åœ¨æ¯•ä¸šè®¾è®¡çš„æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œç»è¿‡å¹¿æ³›é˜…è¯»å„ç§å„æ ·çš„æ–‡çŒ®èµ„æ–™ï¼Œç²¾å¿ƒè®¾è®¡å¹¶æˆåŠŸå®ç°å‡ºäº†è€å¹´äººäººèº«å®‰å…¨ç›‘æŠ¤ç³»ç»Ÿã€‚é€šè¿‡æ­¤æ¬¡æ¯•ä¸šè®¾è®¡ï¼Œå­¦ä¼šäº†STM32å•ç‰‡æœºä»¥åŠä¼ æ„Ÿå™¨çš„ç¼–ç¨‹æ€è·¯ï¼Œæå¤§åœ°é”»ç‚¼äº†è‡ªèº«çš„ç¼–ç¨‹èƒ½åŠ›ã€‚ä»ä¹¦æœ¬ä¸Šçœ‹ä¼¼æ¸…æ™°æ˜äº†çš„çŸ¥è¯†è¿‡æ¸¡åˆ°å®é™…æ“ä½œå®ç‰©æ—¶çš„èŒ«ç„¶æ— æªï¼Œç„¶è€Œé€šè¿‡æŒç»­ä¸æ–­åœ°å­¦ä¹ ä»¥åŠè™šå¿ƒè¯·æ•™ä»–äººï¼Œç§¯æåŠªåŠ›åœ°å»å…‹æœåœ¨ç¼–ç è¿‡ç¨‹ä¸­é‡åˆ°çš„ç§ç§å›°éš¾ï¼Œè¿™ä¹Ÿä¸ºæˆ‘å°†æ¥çš„å­¦ä¹ è·¯çº¿æä¾›äº†æ›´æƒ³è¦æ·±å…¥å»äº†è§£å’Œæ¢ç´¢çš„æµ“åšå…´è¶£ã€‚</p><p>é€šè¿‡æœ¬æ¬¡æ¯•ä¸šè®¾è®¡çš„æ¨è¿›ä¸å®Œæˆï¼Œä¸ä½†åˆ‡å®åœ°å°†ç†è®ºä¸å®è·µç´§å¯†åœ°è¿›è¡Œäº†ç»“åˆï¼Œè€Œä¸”è¿˜è¿›ä¸€æ­¥æ‹“å±•äº†è‡ªå·±çš„çŸ¥è¯†å‚¨å¤‡é‡ã€‚æ·±å…¥äº†è§£äº†ä¸€ä¸ªç³»ç»Ÿä»æœ€åˆçš„è®¾è®¡éœ€æ±‚ç¡®ç«‹ï¼Œåˆ°åŠŸèƒ½é€æ­¥å®ç°ï¼Œå†åˆ°åŠŸèƒ½æµ‹è¯•çš„å…¨éƒ¨å®Œæ•´è¿‡ç¨‹ã€‚è¿™æ— ç–‘ä¸ºæˆ‘æœªæ¥çš„å·¥ä½œç§¯ç´¯äº†æä¸ºéš¾å¾—çš„å®è´µç»éªŒï¼Œè®©æˆ‘èƒ½å¤Ÿä»¥æ›´åŠ ä»å®¹è‡ªä¿¡çš„å§¿æ€å»é¢å¯¹æœªæ¥èŒä¸šç”Ÿæ¶¯ä¸­çš„å„ç§æŒ‘æˆ˜å’Œæœºé‡ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> STM32 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> STM32 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€Springç¯‡ã€‘æ¨¡æ‹Ÿç½‘ç«™ç™»å½•è·å–Token</title>
      <link href="/posts/2024/3361359797.html"/>
      <url>/posts/2024/3361359797.html</url>
      
        <content type="html"><![CDATA[<h2 id="æ¨¡æ‹Ÿç™»å½•è®¿é—®è·å–token"><a href="#æ¨¡æ‹Ÿç™»å½•è®¿é—®è·å–token" class="headerlink" title="æ¨¡æ‹Ÿç™»å½•è®¿é—®è·å–token"></a>æ¨¡æ‹Ÿç™»å½•è®¿é—®è·å–token</h2><img src="https://s21.ax1x.com/2024/07/18/pkowdV1.png" alt="åå°ç®¡ç†ç³»ç»Ÿç•Œé¢" style="zoom: 33%;" /><blockquote><p>å½“è¿›è¡Œè®¿é—®ä¸€ä¸ªç½‘ç«™éƒ½ä¼šè¿›è¡Œç™»å½•ç›¸å…³çš„æ“ä½œï¼Œåœ¨æƒ³è·å–è¯¥ç½‘ç«™tokençš„æ—¶å€™ï¼Œå¯ä»¥è¿›è¡Œç™»å½•åæ‹¿åˆ°è¯¥ç½‘ç«™çš„token  å¯ä½œä¸ºçš„ç”¨é€”æˆ‘ä»¬å¯ä»¥æŠŠç½‘ç«™tokenæ‹¿åˆ°ï¼Œåšä¸€äº›æ¥å£è¿›è¡Œæ“ä½œã€‚</p></blockquote><p>æœ¬æ–‡åŸºäºVUE+SpringBootæ¡†æ¶è¿›è¡Œå¼€å‘çš„åå°ç®¡ç†ç³»ç»Ÿä¸Šè¿›è¡Œæ¨¡æ‹Ÿç™»å½•ï¼ŒéªŒè¯ç è§£ç è·å– è·å–tokenæ“ä½œã€‚</p><h2 id="åå°æ¥å£çš„è¯·æ±‚å¤„ç†"><a href="#åå°æ¥å£çš„è¯·æ±‚å¤„ç†" class="headerlink" title="åå°æ¥å£çš„è¯·æ±‚å¤„ç†"></a>åå°æ¥å£çš„è¯·æ±‚å¤„ç†</h2><p>å½“åœ¨ä½¿ç”¨ç½‘ç«™æ—¶é¦–å…ˆè¿›è¡Œloginé¡µé¢çš„æŸ¥æ‰¾ï¼Œå› ä¸ºæœ‰äº›é¡µé¢ä¼šè®©æˆ‘ä»¬å»getè¯·æ±‚ï¼Œä»è€Œåœ¨æœ¬æœºæµè§ˆå™¨ç¯å¢ƒä¸‹ç”ŸæˆCookieä¿¡æ¯ï¼Œ<strong>ç”ŸæˆåŸå› å‘¢ï¼Ÿ</strong>å°±æ˜¯ä»–åœ¨postè¯·æ±‚çš„æ—¶å€™ä¹Ÿä¼šå»æºå¸¦Cookieçš„æ•°æ®ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p><img src="https://s21.ax1x.com/2024/07/18/pkowqqs.png" alt="Cookie" style="zoom: 50%;" /><p>æœ‰äº›ç½‘ç«™ä¹Ÿæ˜¯å¾ˆå¥½å»æ¨¡æ‹Ÿç™»å½•çš„ï¼Œä»–ä¸éœ€è¦æˆ‘ä»¬å»è¿›è¡Œgetè¯·æ±‚é¡µé¢ç”Ÿäº§cookieå¯ä»¥ç›´æ¥è¿›è¡Œpostæ•°æ®è¯·æ±‚æŠŠç™»å½•çš„infoä¿¡æ¯è¿›è¡Œå‘é€è¿‡å»è¿›è¡ŒéªŒè¯ç™»å½•å³å¯ã€‚</p><img src="https://s21.ax1x.com/2024/07/18/pko0SRU.png" alt="ç›´æ¥è¯·æ±‚çš„loginæ¥å£" style="zoom:50%;" /><p>åœ¨è¯·æ±‚ç½‘ç«™çš„æ—¶å€™ä½¿ç”¨åˆ°çš„ä»£ç -&gt; è¯¥ç¯å¢ƒæ˜¯åœ¨SpringBootæ¡†æ¶ä¸‹è¿›è¡Œæ“ä½œçš„ã€‚  </p><p>å¯¼å…¥ä¸»è¦ä½¿ç”¨åˆ°çš„ä¾èµ–ç¯å¢ƒ</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Inherit defaults from Spring Boot --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">parent</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-parent<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.3.1.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">relativePath</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">parent</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- Add typical dependencies for a web application --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><p>æ¥ä¸‹æ¥ï¼Œè¿›è¡Œç™»å½•é¡µçš„è¯·æ±‚ï¼Œä½¿ç”¨çš„æ˜¯restTemplateæ¨¡æ¿ä¸‹çš„exchangeæ–¹æ³•</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">ResponseEntity&lt;T&gt; <span class="title function_">exchange</span><span class="params">(URI url, HttpMethod method, <span class="meta">@Nullable</span> HttpEntity&lt;?&gt; requestEntity,</span></span><br><span class="line"><span class="params">        ParameterizedTypeReference&lt;T&gt; responseType)</span> <span class="keyword">throws</span> RestClientException;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *</span></span><br><span class="line"><span class="comment"> url â€“ the URL   ç½‘ç«™çš„URL</span></span><br><span class="line"><span class="comment"> method â€“ the HTTP method (GET, POST, etc)  ç½‘ç«™è¿›è¡Œè¯·æ±‚çš„æ–¹æ³• </span></span><br><span class="line"><span class="comment"> requestEntity â€“ the entity (headers and/or body) to write to the request (may be null)  è¯·æ±‚å¤´å’Œè¯·æ±‚ä½“</span></span><br><span class="line"><span class="comment"> responseType â€“ the type of the return value              è¿”å›æŒ‡å®šç±»å‹å€¼</span></span><br><span class="line"><span class="comment"> */</span></span><br></pre></td></tr></table></figure><p>åœ¨è¿›è¡Œç½‘ç«™æ¨¡æ‹Ÿè¯·æ±‚çš„æ—¶å€™æ°¸è¿œç»•ä¸è¿‡å»çš„å°±æ˜¯éªŒè¯ç ç¯èŠ‚ï¼Œå› ä¸ºJavaä¸åƒpythoné‚£æ ·æœ‰å¼ºå¤§çš„çˆ¬è™«åº“å¯ä»¥æ“ä½œï¼Œæœ¬æ¬¡æ“ä½œæ˜¯åŸºäºç¬¬ä¸‰æ–¹APIæ¥å£è¿›è¡Œçš„æ“ä½œã€‚</p><p><img src="https://s21.ax1x.com/2024/07/18/pko0yF0.png" alt="éªŒè¯ç "></p><h2 id="æ¨¡æ‹ŸéªŒè¯ç æ“ä½œ-è·å–éªŒè¯ç "><a href="#æ¨¡æ‹ŸéªŒè¯ç æ“ä½œ-è·å–éªŒè¯ç " class="headerlink" title="æ¨¡æ‹ŸéªŒè¯ç æ“ä½œ è·å–éªŒè¯ç "></a><strong>æ¨¡æ‹ŸéªŒè¯ç æ“ä½œ</strong> è·å–éªŒè¯ç </h2><p>æœ¬æ¬¡æ¨¡æ‹Ÿæ¥å£æ˜¯ <a href="http://localhost:8501/admin/system/index/generateValidateCode">http://localhost:8501/admin/system/index/generateValidateCode</a>  è‡ªå·±æ­å»ºç”Ÿäº§çš„éªŒè¯ç éªŒè¯æœåŠ¡ã€‚</p><p><img src="https://s21.ax1x.com/2024/07/18/pko0cWT.png" alt="éªŒè¯ç è¯·æ±‚æ•°æ®"></p><p>åœ¨è¯·æ±‚è¯¥æ¥å£çš„æ—¶å€™è·å–åˆ° codeï¼Œmessageï¼Œdataä¸‰ä¸ªjsonæ•°æ®ï¼Œæˆ‘ä»¬ä¸»è¦å¯¹dataçš„æ•°æ®codeKeyå’ŒcodeValueè¿›è¡Œæ“ä½œã€‚</p><p>è¯¥codeValueçš„æ•°æ®æ˜¯base64å›¾ç‰‡æ ¼å¼æ•°æ®ï¼Œæˆ‘ä»¬å°±å¾—æ•°æ®æ‹¿åˆ°å‘é€åˆ°æˆ‘ä»¬apiå¤„ç†æ¥å£ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">HttpHeaders</span> <span class="variable">headers</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HttpHeaders</span>();</span><br><span class="line"> headers.add(<span class="string">&quot;User-Agent&quot;</span>,<span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36 SLBrowser/9.0.3.5211 SLBChan/112&quot;</span>);</span><br><span class="line"> HttpEntity&lt;MultiValueMap&lt;String,String&gt;&gt; startPage  = <span class="keyword">new</span> <span class="title class_">HttpEntity</span>&lt;&gt;(headers);  <span class="comment">// æ„å»ºè¯·æ±‚å¤´å’Œè¯·æ±‚ä½“</span></span><br><span class="line"></span><br><span class="line">     </span><br><span class="line"> <span class="type">URI</span> <span class="variable">url</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URI</span>(ValidateCodeUrl);                                              <span class="comment">//è½¬æ¢æˆURIçš„æ ¼å¼</span></span><br><span class="line"> ResponseEntity&lt;String&gt; response = restTemplate.exchange(url,HttpMethod.GET,startPage,String.class);</span><br><span class="line"> <span class="type">ObjectMapper</span> <span class="variable">mapper</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">ObjectMapper</span>();                                       <span class="comment">//ä½¿ç”¨FastJsonè¿›è¡Œå¤„ç†</span></span><br><span class="line"> <span class="type">JsonNode</span> <span class="variable">jsonNode</span> <span class="operator">=</span> mapper.readTree(response.getBody());</span><br><span class="line"> <span class="type">String</span>  <span class="variable">codeKey</span> <span class="operator">=</span> String.valueOf(jsonNode.get(<span class="string">&quot;data&quot;</span>).get(<span class="string">&quot;codeKey&quot;</span>)).replaceAll(<span class="string">&quot;\&quot;&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line"> <span class="type">String</span> <span class="variable">Imgbase</span> <span class="operator">=</span> String.valueOf(jsonNode.get(<span class="string">&quot;data&quot;</span>).get(<span class="string">&quot;codeValue&quot;</span>)).replaceAll(<span class="string">&quot;\&quot;&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br></pre></td></tr></table></figure><p>æ‹¿åˆ°dataä¸­çš„Imgbaseæ•°æ®ï¼Œæ¥ä¸‹æ¥ä½¿ç”¨APIçš„æ¥å£è¿›è¡Œæ“ä½œï¼Œå¯æŸ¥çœ‹å®˜æ–¹ç«¯å£è¿›è¡ŒæŸ¥çœ‹<a href="https://www.jfbym.com/price.html">https://www.jfbym.com/price.html</a></p><p><img src="https://s21.ax1x.com/2024/07/18/pko0LlD.png" alt="è¯†åˆ«æˆåŠŸ"></p><blockquote><p>&#x2F;&#x2F; # é€šç”¨æ•°è‹±1-4ä½ 10110</p><p>&#x2F;&#x2F; # é€šç”¨æ•°è‹±5-8ä½ 10111                                                    è§„å®šæ¥å£ä¸Šä¼ æ•°æ®å¿…é¡»<strong>base64</strong></p><p>&#x2F;&#x2F; # é€šç”¨æ•°è‹±9~11ä½ 10112                   </p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> ResponseEntity&lt;String&gt; <span class="title function_">commonVerify</span><span class="params">(String imageContent)</span> <span class="keyword">throws</span> URISyntaxException &#123;</span><br><span class="line">    String verify_type;</span><br><span class="line">    verify_type = <span class="string">&quot;10110&quot;</span>;</span><br><span class="line">    <span class="type">HttpHeaders</span> <span class="variable">verifyHeader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HttpHeaders</span>();</span><br><span class="line">    verifyHeader.add(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/json&quot;</span>);</span><br><span class="line">    <span class="type">JSONObject</span> <span class="variable">jsonObject</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JSONObject</span>();</span><br><span class="line">    jsonObject.put(<span class="string">&quot;image&quot;</span>, imageContent);</span><br><span class="line">    jsonObject.put(<span class="string">&quot;type&quot;</span>, verify_type);</span><br><span class="line">    jsonObject.put(<span class="string">&quot;token&quot;</span>, Token);</span><br><span class="line">    <span class="type">HttpEntity</span> <span class="variable">startEntity</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HttpEntity</span>&lt;&gt;(jsonObject,verifyHeader);</span><br><span class="line"></span><br><span class="line">    System.out.println(<span class="string">&quot;startEntity = &quot;</span> + startEntity);</span><br><span class="line">    <span class="type">URI</span> <span class="variable">captch</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">URI</span>(CustomUrl);</span><br><span class="line">    ResponseEntity&lt;String&gt; response = restTemplate.exchange(captch,HttpMethod.POST,startEntity,String.class);</span><br><span class="line">    System.out.println(response);</span><br><span class="line">    <span class="keyword">return</span> response;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="è¿›è¡Œæ¨¡æ‹Ÿç™»å½•"><a href="#è¿›è¡Œæ¨¡æ‹Ÿç™»å½•" class="headerlink" title="è¿›è¡Œæ¨¡æ‹Ÿç™»å½•"></a>è¿›è¡Œæ¨¡æ‹Ÿç™»å½•</h2><p>åœ¨é€šè¿‡commonVerifyæ¥å£å®ŒæˆéªŒè¯ç çš„è¯†åˆ«åï¼Œå°†è·å–åˆ°çš„æ•°æ®è¿›è¡Œæ„å»ºjsonæ•°æ®<strong>mapper.readTree</strong>ï¼Œåœ¨jsonNodeä¸­æ‹¿å»æ‰€éœ€è¦çš„æ•°æ®ã€‚</p><p><img src="https://s21.ax1x.com/2024/07/18/pko0x0A.png" alt="è¿”å›å‚æ•°"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ResponseEntity&lt;String&gt; response1 = commonVerify(Imgbase);</span><br><span class="line">jsonNode = mapper.readTree(response1.getBody());</span><br><span class="line"><span class="type">String</span> <span class="variable">captcha</span> <span class="operator">=</span> String.valueOf(jsonNode.get(<span class="string">&quot;data&quot;</span>).get(<span class="string">&quot;data&quot;</span>)).replaceAll(<span class="string">&quot;\&quot;&quot;</span>,<span class="string">&quot;&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="type">HttpHeaders</span> <span class="variable">postHeader</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HttpHeaders</span>();</span><br><span class="line">postHeader.add(<span class="string">&quot;User-Agent&quot;</span>,<span class="string">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/109.0.0.0 Safari/537.36 SLBrowser/9.0.3.5211 SLBChan/112&quot;</span>);</span><br><span class="line">         </span><br></pre></td></tr></table></figure><blockquote><p>åœ¨æ­¤æˆ‘ä»¬å°±æ‹¿åˆ°äº†codekeyå’ŒcodeValue  å†é…ä¸Šæˆ‘ä»¬æ‰€æ·»åŠ çš„usernameå’Œpassword å°±æ„å»ºç™»å½•è¯·æ±‚ä½“æ•°æ®</p></blockquote><p>åœ¨æ­¤ä¹Ÿéœ€è¦åˆ¤æ–­ loginè¯·æ±‚éœ€è¦çš„æ˜¯jsonæ ¼å¼è¿˜æ˜¯å…¶ä½™æ ¼å¼ã€‚</p><img src="https://s21.ax1x.com/2024/07/18/pkoBe7n.png" alt="ç¬¬ä¸€ç§" style="zoom: 50%;" /><p>æ ¹æ®æ‰€éœ€è¦çš„æ ¼å¼ï¼Œå»æ„å»ºHttpEntityçš„å®ä½“ç±»ï¼Œè¯¥æ“ä½œæ˜¯è¯·æ±‚ä½“å’Œè¯·æ±‚å¤´çš„æ–¹å¼ï¼Œè¯·æ±‚ä½“é€šè¿‡jsonçš„å½¢å¼</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">postHeader.add(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/json&quot;</span>);</span><br><span class="line">         <span class="type">JSONObject</span> <span class="variable">jsonObject</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">JSONObject</span>();</span><br><span class="line">         jsonObject.put(<span class="string">&quot;userName&quot;</span>, username);</span><br><span class="line">         jsonObject.put(<span class="string">&quot;password&quot;</span>, password);</span><br><span class="line">         jsonObject.put(<span class="string">&quot;captcha&quot;</span>, captcha);</span><br><span class="line">         jsonObject.put(<span class="string">&quot;codeKey&quot;</span>, codeKey);</span><br><span class="line"></span><br><span class="line">         <span class="type">HttpEntity</span> <span class="variable">httpEntity</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">HttpEntity</span>&lt;&gt;(jsonObject,postHeader);</span><br><span class="line"></span><br><span class="line">         url = <span class="keyword">new</span> <span class="title class_">URI</span>(loginUrl);</span><br><span class="line">         ResponseEntity&lt;String&gt; exchange = restTemplate.exchange(url, HttpMethod.POST, httpEntity, String.class);</span><br><span class="line">         System.out.println(<span class="string">&quot;exchange = &quot;</span> + exchange);</span><br></pre></td></tr></table></figure><p>å®Œæˆï¼Œè·å–åˆ°tokenæ•°æ®ï¼ï¼ï¼</p>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Spring </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€SpringBootç¯‡ã€‘ç™»å½•æ ¡éªŒæ‹¦æˆªå™¨è®¾ç½®</title>
      <link href="/posts/2024/639972599.html"/>
      <url>/posts/2024/639972599.html</url>
      
        <content type="html"><![CDATA[<h2 id="éœ€æ±‚åˆ†æ"><a href="#éœ€æ±‚åˆ†æ" class="headerlink" title="éœ€æ±‚åˆ†æ"></a>éœ€æ±‚åˆ†æ</h2><p>åå°ç®¡ç†ç³»ç»Ÿä¸­é™¤äº†ç™»å½•æ¥å£ã€è·å–éªŒè¯ç çš„æ¥å£åœ¨è®¿é—®çš„æ—¶å€™ä¸éœ€è¦éªŒè¯ç”¨æˆ·çš„ç™»å½•çŠ¶æ€ï¼Œå…¶ä½™çš„æ¥å£åœ¨è®¿é—®çš„æ—¶å€™éƒ½å¿…é¡»è¦æ±‚ç”¨æˆ·ç™»å½•æˆåŠŸä»¥åæ‰å¯ä»¥è¿›è¡Œè®¿é—®ã€‚</p><p>ç™»å½•è¿‡ç¨‹<br><img src="https://s21.ax1x.com/2024/07/16/pkIRPi9.png" alt="æ‹¦æˆªå™¨é…ç½®è¿‡ç¨‹"></p><p><img src="https://s21.ax1x.com/2024/07/16/pkI2xqU.png" alt="æ‹¦æˆªå™¨é…ç½®è¯´æ˜"></p><blockquote><p>å‰ç«¯è¯·æ±‚url ç»è¿‡æ‹¦æˆªå™¨ï¼ˆæ”¾è¡Œç™»å½•å’ŒéªŒè¯ç ï¼‰è¿›è¡Œåˆ¤æ–­è·å–åˆ°tokenï¼Œä»Redisä¸­æŸ¥è¯¢æ•°æ®æ˜¯å¦å­˜åœ¨ï¼Œ<br>è‹¥æ•°æ®å­˜åœ¨æ”¾åœ¨ThreadLocalçº¿ç¨‹å˜é‡ä¸­ï¼Œæ›´æ–°redis tokenå­˜å‚¨çš„æ—¶é—´å¹¶æ”¾è¡Œ<br>è‹¥ä¸å­˜åœ¨è¿”å›208çŠ¶æ€ç  è¿”å›å‰ç«¯é¡µé¢</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.atguigu.spzx.common.util;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> com.atguigu.spzx.model.entity.system.SysUser;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AuthContextUtil</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ›å»ºä¸€ä¸ªThreadLocalå¯¹è±¡</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> ThreadLocal&lt;SysUser&gt; threadLocal = <span class="keyword">new</span> <span class="title class_">ThreadLocal</span>&lt;&gt;() ;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®šä¹‰å­˜å‚¨æ•°æ®çš„é™æ€æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">set</span><span class="params">(SysUser sysUser)</span> &#123;</span><br><span class="line">        threadLocal.set(sysUser);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å®šä¹‰è·å–æ•°æ®çš„æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> SysUser <span class="title function_">get</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> threadLocal.get() ;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// åˆ é™¤æ•°æ®çš„æ–¹æ³•</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title function_">remove</span><span class="params">()</span> &#123;</span><br><span class="line">        threadLocal.remove();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="æ‹¦æˆªå™¨Hander"><a href="#æ‹¦æˆªå™¨Hander" class="headerlink" title="æ‹¦æˆªå™¨Hander"></a>æ‹¦æˆªå™¨Hander</h2><blockquote><p>UserAuthProperties ç”¨äºè¯»å–ymlä¸­çš„å‚æ•°</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;spzx.auth&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">UserAuthProperties</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> List&lt;String&gt;  noAuthUrls;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">LoginAuthInterceptor</span> <span class="keyword">implements</span> <span class="title class_">HandlerInterceptor</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    RedisTemplate&lt;String , String&gt; redisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="type">boolean</span> <span class="title function_">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è·å–é¢„æ£€è¯·æ±‚æ”¾è¡Œ</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">method</span> <span class="operator">=</span> request.getMethod();</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;OPTIONS&quot;</span>.equals(method))&#123;</span><br><span class="line">            <span class="keyword">return</span>  <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//å–å¾—token</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">token</span> <span class="operator">=</span> request.getHeader(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(StrUtil.isEmpty(token))</span><br><span class="line">        &#123;</span><br><span class="line">            responseNoLoginInfo(response) ;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//å¾—åˆ°ç”¨æˆ·json</span></span><br><span class="line"></span><br><span class="line">        <span class="type">String</span> <span class="variable">userInfoJSON</span> <span class="operator">=</span> redisTemplate.opsForValue().get(CacheConstant.User_Login_Prefix + token);</span><br><span class="line">        <span class="keyword">if</span>(StrUtil.isEmpty(userInfoJSON))</span><br><span class="line">        &#123;</span><br><span class="line">            responseNoLoginInfo(response) ;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span> ;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//jsonå­˜åˆ°threadLocal</span></span><br><span class="line">        <span class="type">SysUser</span> <span class="variable">sysUser</span> <span class="operator">=</span> JSON.parseObject(userInfoJSON, SysUser.class);</span><br><span class="line">        AuthContextUtil.set(sysUser);</span><br><span class="line">        <span class="comment">//é‡ç½®redis</span></span><br><span class="line"></span><br><span class="line">        redisTemplate.expire(CacheConstant.User_Login_Prefix + token,<span class="number">30</span>, TimeUnit.MINUTES);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span> <span class="title function_">responseNoLoginInfo</span><span class="params">(HttpServletResponse response)</span> &#123;</span><br><span class="line">        Result&lt;Object&gt; result = Result.build(<span class="literal">null</span>, ResultCodeEnum.LOGIN_AUTH);</span><br><span class="line">        <span class="type">PrintWriter</span> <span class="variable">writer</span> <span class="operator">=</span> <span class="literal">null</span>;</span><br><span class="line">        response.setCharacterEncoding(<span class="string">&quot;UTF-8&quot;</span>);</span><br><span class="line">        response.setContentType(<span class="string">&quot;text/html; charset=utf-8&quot;</span>);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            writer = response.getWriter();</span><br><span class="line">            writer.print(JSON.toJSONString(result));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (writer != <span class="literal">null</span>) writer.close();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object handler, ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        AuthContextUtil.remove();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="é…ç½®æ‹¦æˆªå™¨"><a href="#é…ç½®æ‹¦æˆªå™¨" class="headerlink" title="é…ç½®æ‹¦æˆªå™¨"></a>é…ç½®æ‹¦æˆªå™¨</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">WebMvcConfiguration</span>  <span class="keyword">implements</span> <span class="title class_">WebMvcConfigurer</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    LoginAuthInterceptor loginAuthInterceptor;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    UserAuthProperties userAuthProperties;</span><br><span class="line"></span><br><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*ç™»å½•æ ¡éªŒ</span></span><br><span class="line"><span class="comment">**/</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addInterceptors</span><span class="params">(InterceptorRegistry registry)</span> &#123;</span><br><span class="line">        registry.addInterceptor(loginAuthInterceptor)</span><br><span class="line">                .excludePathPatterns(userAuthProperties.getNoAuthUrls())</span><br><span class="line">                .addPathPatterns(<span class="string">&quot;/**&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*CROSè·¨åŸŸ</span></span><br><span class="line"><span class="comment">**/</span></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">addCorsMappings</span><span class="params">(CorsRegistry registry)</span> &#123;</span><br><span class="line">        registry.addMapping(<span class="string">&quot;/**&quot;</span>)      <span class="comment">// æ·»åŠ è·¯å¾„è§„åˆ™</span></span><br><span class="line">                .allowCredentials(<span class="literal">true</span>)               <span class="comment">// æ˜¯å¦å…è®¸åœ¨è·¨åŸŸçš„æƒ…å†µä¸‹ä¼ é€’Cookie</span></span><br><span class="line">                .allowedOriginPatterns(<span class="string">&quot;*&quot;</span>)           <span class="comment">// å…è®¸è¯·æ±‚æ¥æºçš„åŸŸè§„åˆ™</span></span><br><span class="line">                .allowedMethods(<span class="string">&quot;*&quot;</span>)</span><br><span class="line">                .allowedHeaders(<span class="string">&quot;*&quot;</span>) ;                <span class="comment">// å…è®¸æ‰€æœ‰çš„è¯·æ±‚å¤´</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SpringBoot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€SpringBootç¯‡ã€‘è‡ªå®šä¹‰å¼‚å¸¸å¤„ç†</title>
      <link href="/posts/2024/2677420933.html"/>
      <url>/posts/2024/2677420933.html</url>
      
        <content type="html"><![CDATA[<h2 id="ğŸˆå¼‚å¸¸å¤„ç†"><a href="#ğŸˆå¼‚å¸¸å¤„ç†" class="headerlink" title="ğŸˆå¼‚å¸¸å¤„ç†"></a>ğŸˆå¼‚å¸¸å¤„ç†</h2><p>åœ¨ Java ä¸­ï¼Œè‡ªå®šä¹‰å¼‚å¸¸æ˜¯æŒ‡ç”¨æˆ·æ ¹æ®è‡ªå·±çš„éœ€æ±‚åˆ›å»ºçš„å¼‚å¸¸ç±»ã€‚Java æä¾›äº†ä¸€äº›é¢„å®šä¹‰çš„å¼‚å¸¸ç±»ï¼Œå¦‚ <strong>NullPointerException</strong>ã€<strong>ArrayIndexOutOfBoundsException</strong>ç­‰ï¼Œä½†æœ‰æ—¶è¿™äº›é¢„å®šä¹‰çš„å¼‚å¸¸ç±»å¹¶ä¸èƒ½å®Œå…¨æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ›å»ºè‡ªå®šä¹‰å¼‚å¸¸ç±»æ¥è¡¨ç¤ºç‰¹å®šçš„å¼‚å¸¸æƒ…å†µã€‚</p><p>è‡ªå®šä¹‰å¼‚å¸¸ç±»é€šå¸¸ç»§æ‰¿è‡ª Exception ç±»æˆ– RuntimeException ç±»ï¼Œä»¥åŠå®ƒä»¬çš„å­ç±»ï¼Œå¹¶æ ¹æ®éœ€è¦æ·»åŠ ç›¸åº”çš„æ„é€ æ–¹æ³•å’Œå…¶ä»–æ–¹æ³•ä»¥æ»¡è¶³ç‰¹å®šçš„å¼‚å¸¸å¤„ç†éœ€æ±‚ï¼Œè‡ªå®šä¹‰å¼‚å¸¸ç±»å¯ä»¥åŒ…å«é¢å¤–çš„å±æ€§å’Œæ–¹æ³•ï¼Œä»¥æä¾›æ›´å¤šçš„ä¿¡æ¯å’ŒåŠŸèƒ½ã€‚</p><p>ä½¿ç”¨è‡ªå®šä¹‰å¼‚å¸¸ç±»æ—¶ï¼Œé€šå¸¸çš„åšæ³•æ˜¯åœ¨æ–¹æ³•ä¸­ä½¿ç”¨ throw è¯­å¥æ¥æŠ›å‡ºè‡ªå®šä¹‰å¼‚å¸¸ï¼Œç„¶ååœ¨è°ƒç”¨è¯¥æ–¹æ³•çš„åœ°æ–¹ä½¿ç”¨ try-catch è¯­å¥å—æ¥æ•è·å¹¶å¤„ç†å¼‚å¸¸ã€‚</p><p><img src="https://s21.ax1x.com/2024/07/16/pkI2JUJ.png" alt="å¼‚å¸¸ç±»"></p><blockquote><p>æˆ‘ä»¬æƒ³è®©å¼‚å¸¸ç»“æœä¹Ÿæ˜¾ç¤ºä¸ºç»Ÿä¸€çš„è¿”å›ç»“æœå¯¹è±¡ï¼Œå¹¶ä¸”ç»Ÿä¸€å¤„ç†ç³»ç»Ÿçš„å¼‚å¸¸ä¿¡æ¯ï¼Œé‚£ä¹ˆï¼Œéœ€è¦ç»Ÿä¸€å¼‚å¸¸å¤„ç†</p></blockquote><h2 id="ğŸ†ç»Ÿä¸€å¼‚å¸¸å¤„ç†å™¨"><a href="#ğŸ†ç»Ÿä¸€å¼‚å¸¸å¤„ç†å™¨" class="headerlink" title="ğŸ†ç»Ÿä¸€å¼‚å¸¸å¤„ç†å™¨"></a>ğŸ†ç»Ÿä¸€å¼‚å¸¸å¤„ç†å™¨</h2><blockquote><p>@ExceptionHandler(Exception.class)<br>@ControllerAdvice</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç»Ÿä¸€å¼‚å¸¸å¤„ç†ç±»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@ControllerAdvice</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GlobalExceptionHander</span> &#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@ExceptionHandler(Exception.class)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">error</span><span class="params">(Exception e)</span>&#123;</span><br><span class="line">e.printStackTrace();</span><br><span class="line"><span class="keyword">return</span>  Result.build(<span class="literal">null</span>,<span class="number">201</span>,<span class="string">&quot;å‡ºç°äº†å¼‚å¸¸&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">   <span class="comment">/**</span></span><br><span class="line"><span class="comment">    * ç‰¹å®šçš„å¼‚å¸¸å¤„ç†</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line"></span><br><span class="line">   <span class="meta">@ExceptionHandler(ArithmeticException.class)</span></span><br><span class="line">   <span class="meta">@ResponseBody</span></span><br><span class="line">   <span class="keyword">public</span> Result <span class="title function_">error</span><span class="params">(ArithmeticException e)</span>&#123;</span><br><span class="line">       e.printStackTrace();</span><br><span class="line">       <span class="keyword">return</span>  Result.build(<span class="literal">null</span>,<span class="number">202</span>,<span class="string">&quot;ç‰¹å®šçš„å¼‚å¸¸&quot;</span>);</span><br><span class="line">   &#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="ğŸ€è‡ªå®šä¹‰å¼‚å¸¸"><a href="#ğŸ€è‡ªå®šä¹‰å¼‚å¸¸" class="headerlink" title="ğŸ€è‡ªå®šä¹‰å¼‚å¸¸"></a>ğŸ€è‡ªå®šä¹‰å¼‚å¸¸</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GuiguException</span>  <span class="keyword">extends</span>  <span class="title class_">RuntimeException</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer CODE;</span><br><span class="line">    <span class="keyword">private</span> String  message;</span><br><span class="line">    <span class="keyword">private</span> ResultCodeEnum resultCodeEnum;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">GuiguException</span><span class="params">()</span> &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">GuiguException</span><span class="params">(Integer CODE, String message)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.CODE = CODE;</span><br><span class="line">        <span class="built_in">this</span>.message = message;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="title function_">GuiguException</span><span class="params">(ResultCodeEnum resultCodeEnum)</span> &#123;</span><br><span class="line">        <span class="built_in">this</span>.CODE = resultCodeEnum.getCode();</span><br><span class="line">        <span class="built_in">this</span>.message = resultCodeEnum.getMessage();</span><br><span class="line">        <span class="built_in">this</span>.resultCodeEnum = resultCodeEnum;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * è‡ªå®šä¹‰å¼‚å¸¸</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@ExceptionHandler(GuiguException.class)</span></span><br><span class="line"><span class="meta">@ResponseBody</span></span><br><span class="line"><span class="keyword">public</span> Result <span class="title function_">error</span><span class="params">(GuiguException e)</span></span><br><span class="line">&#123;</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">    <span class="keyword">return</span> Result.build(<span class="literal">null</span>,e.getCODE(),e.getMessage());</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SpringBoot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€SpringBootç¯‡ã€‘é˜¿é‡Œäº‘OSS--æ–‡ä»¶å­˜å‚¨</title>
      <link href="/posts/2024/2973527109.html"/>
      <url>/posts/2024/2973527109.html</url>
      
        <content type="html"><![CDATA[<h2 id="ğŸŒ¹ä»€ä¹ˆæ˜¯é˜¿é‡Œäº‘OSS"><a href="#ğŸŒ¹ä»€ä¹ˆæ˜¯é˜¿é‡Œäº‘OSS" class="headerlink" title="ğŸŒ¹ä»€ä¹ˆæ˜¯é˜¿é‡Œäº‘OSS"></a>ğŸŒ¹ä»€ä¹ˆæ˜¯é˜¿é‡Œäº‘OSS</h2><p>é˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨ï¼ˆAlibaba Cloud Object Storage Serviceï¼Œç®€ç§°OSSï¼‰æ˜¯é˜¿é‡Œäº‘æä¾›çš„æµ·é‡ã€å®‰å…¨ã€ä½æˆæœ¬ã€é«˜å¯é çš„äº‘å­˜å‚¨æœåŠ¡ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡ç®€å•çš„APIæ¥å£åœ¨ä»»ä½•æ—¶é—´ã€ä»»ä½•åœ°ç‚¹ä¸Šä¼ å’Œä¸‹è½½æ•°æ®ï¼Œé€‚ç”¨äºå›¾åƒã€éŸ³è§†é¢‘ã€æ–‡æ¡£ã€ç½‘ç«™ç­‰å„ç§ç±»å‹çš„æ•°æ®å­˜å‚¨å’Œåˆ†å‘åœºæ™¯ã€‚</p><h2 id="â­é˜¿é‡Œäº‘OSSçš„ä¼˜ç‚¹"><a href="#â­é˜¿é‡Œäº‘OSSçš„ä¼˜ç‚¹" class="headerlink" title="â­é˜¿é‡Œäº‘OSSçš„ä¼˜ç‚¹"></a>â­é˜¿é‡Œäº‘OSSçš„ä¼˜ç‚¹</h2><p><strong>é«˜å¯é æ€§</strong>ï¼šOSSé‡‡ç”¨äº†å¤šå‰¯æœ¬å­˜å‚¨å’Œå®¹ç¾å¤‡ä»½æœºåˆ¶ï¼Œç¡®ä¿æ•°æ®çš„é«˜å¯é æ€§å’ŒæŒä¹…æ€§ã€‚<br><strong>å®‰å…¨æ€§</strong>ï¼šæ”¯æŒå¤šç§å®‰å…¨ç­–ç•¥ï¼Œå¦‚è®¿é—®æ§åˆ¶ã€åŠ å¯†ä¼ è¾“ç­‰ï¼Œä¿éšœæ•°æ®çš„å®‰å…¨æ€§ã€‚<br><strong>å¼¹æ€§æ‰©å±•</strong>ï¼šæ”¯æŒæŒ‰éœ€å­˜å‚¨å’Œå¼¹æ€§æ‰©å±•ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®å®é™…éœ€æ±‚çµæ´»è°ƒæ•´å­˜å‚¨å®¹é‡ã€‚<br><strong>ä½æˆæœ¬</strong>ï¼šOSSçš„å­˜å‚¨è´¹ç”¨ä½å»‰ï¼Œä¸”æ”¯æŒæŒ‰é‡ä»˜è´¹æ¨¡å¼ï¼Œä½¿ç”¨æˆ·èƒ½å¤Ÿæ ¹æ®å®é™…ä½¿ç”¨é‡ä»˜è´¹</p><h2 id="ğŸ³ï¸â€ğŸŒˆä¸ºä»€ä¹ˆè¦ä½¿ç”¨äº‘æœåŠ¡OSS"><a href="#ğŸ³ï¸â€ğŸŒˆä¸ºä»€ä¹ˆè¦ä½¿ç”¨äº‘æœåŠ¡OSS" class="headerlink" title="ğŸ³ï¸â€ğŸŒˆä¸ºä»€ä¹ˆè¦ä½¿ç”¨äº‘æœåŠ¡OSS"></a>ğŸ³ï¸â€ğŸŒˆä¸ºä»€ä¹ˆè¦ä½¿ç”¨äº‘æœåŠ¡OSS</h2><p>è§£å†³æœ¬åœ°å­˜å‚¨æ— æ³•ç›´æ¥è®¿é—®ï¼Œæœ¬åœ°ç£ç›˜ç©ºé—´æœ‰é™ï¼Œæœ¬åœ°ç£ç›˜æŸåè¿™3ä¸ªé—®é¢˜</p><h2 id="ğŸ„ä½¿ç”¨æ­¥éª¤"><a href="#ğŸ„ä½¿ç”¨æ­¥éª¤" class="headerlink" title="ğŸ„ä½¿ç”¨æ­¥éª¤"></a>ğŸ„ä½¿ç”¨æ­¥éª¤</h2><p><img src="https://img2024.cnblogs.com/blog/1931734/202406/1931734-20240604073206273-1833203380.png" alt="image"></p><h2 id="æ–‡ä»¶ä¸Šä¼ æ“ä½œ"><a href="#æ–‡ä»¶ä¸Šä¼ æ“ä½œ" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ æ“ä½œ"></a>æ–‡ä»¶ä¸Šä¼ æ“ä½œ</h2><hr><blockquote><p>ğŸˆåœ¨pomæ–‡ä»¶ä¸­æ·»åŠ ä¸‹é¢çš„ä»£ç </p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;properties&gt;</span><br><span class="line">    &lt;aliyun.sdk.oss&gt;3.10.2&lt;/aliyun.sdk.oss&gt;</span><br><span class="line">&lt;/properties&gt;</span><br><span class="line"></span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">     &lt;groupId&gt;com.aliyun.oss&lt;/groupId&gt;</span><br><span class="line">     &lt;artifactId&gt;aliyun-sdk-oss&lt;/artifactId&gt;</span><br><span class="line">     &lt;version&gt;$&#123;aliyun.sdk.oss&#125;&lt;/version&gt;</span><br><span class="line"> &lt;/dependency&gt;</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>ğŸˆæœ¬åœ°å­˜å‚¨çš„è¯ åœ¨ymlä¸­å†™æ˜å­˜å‚¨åœ°æ–¹</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ali:</span><br><span class="line">  spring:</span><br><span class="line">    localhost: D:\Program Files\Project\Test-Project\TEST01\alioosdemo\ali-service\src\main\resources\upload</span><br></pre></td></tr></table></figure><blockquote><p>ğŸˆåœ¨Controllerå±‚è¿›è¡Œä¸Šä¼ æ“ä½œ</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">@RestController</span><br><span class="line">@RequestMapping(&quot;/api/common&quot;)</span><br><span class="line"></span><br><span class="line">public class CommonController &#123;</span><br><span class="line">    @Value(&quot;$&#123;ali.spring.localhost&#125;&quot;)</span><br><span class="line">    private  String path;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private AliOssUtil aliOssUtil;</span><br><span class="line">    /**</span><br><span class="line">     * æ–‡ä»¶ä¸Šä¼ </span><br><span class="line">     */</span><br><span class="line">    @PostMapping(&quot;upload&quot;)</span><br><span class="line">    public String Upload(MultipartFile file) throws IOException &#123;</span><br><span class="line"></span><br><span class="line">        //è·å–åŸå§‹å</span><br><span class="line">        String originalFilename = file.getOriginalFilename();</span><br><span class="line">        //æˆªå– .png</span><br><span class="line">        String substring = originalFilename.substring(originalFilename.lastIndexOf(&quot;.&quot;));</span><br><span class="line">        //æ„é€ ä¸€ä¸ªæ–°åç§°  ä½¿ç”¨Hutoolå·¥å…·ç±»</span><br><span class="line">        String filename = IdUtil.simpleUUID() + substring;</span><br><span class="line">//æ–°å»ºFileå¯¹è±¡ è¿›è¡Œå­˜å‚¨</span><br><span class="line">        File file1 = new File(filename);</span><br><span class="line">     try &#123;</span><br><span class="line">            file.transferTo(file1);</span><br><span class="line">         &#125; catch (IOException e) &#123;</span><br><span class="line">            throw new RuntimeException(e);</span><br><span class="line">         &#125;</span><br><span class="line">         return  &quot;ä¸Šä¼ æˆåŠŸ&quot;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ–‡ä»¶ä¸Šä¼ æ“ä½œï¼ˆOSSç‰ˆï¼‰"><a href="#æ–‡ä»¶ä¸Šä¼ æ“ä½œï¼ˆOSSç‰ˆï¼‰" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ æ“ä½œï¼ˆOSSç‰ˆï¼‰"></a>æ–‡ä»¶ä¸Šä¼ æ“ä½œï¼ˆOSSç‰ˆï¼‰</h2><blockquote><p>ğŸˆOsså­˜å‚¨ åœ¨ymlä¸­å†™æ˜å­˜å‚¨åœ°æ–¹ <strong>access-key-id</strong>ã€ <strong>access-key-secret</strong>ã€<strong>bucket-name</strong></p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ali:</span><br><span class="line">  alioos:</span><br><span class="line">    endpoint: oss-cn-beijing.aliyuncs.com</span><br><span class="line">    access-key-id: ***********</span><br><span class="line">    access-key-secret: ***********</span><br><span class="line">    bucket-name: ***********</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>ä½¿ç”¨@ConfigurationPropertiesæ³¨è§£è¯»å– propertiesçš„æ•°æ®</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">*</span><br><span class="line">*@Component è¡¨ç¤ºå°†è¯¥ç±»æ ‡è¯†ä¸ºBean</span><br><span class="line">*@ConfigurationProperties(prefix = &quot;ali.alioos&quot;)ç”¨äºç»‘å®šå±æ€§ï¼Œå…¶ä¸­prefixè¡¨ç¤ºæ‰€ç»‘å®šçš„å±æ€§çš„å‰ç¼€ã€‚</span><br><span class="line">**/</span><br><span class="line">@Component</span><br><span class="line">@ConfigurationProperties(prefix = &quot;ali.alioos&quot;)</span><br><span class="line">@Data</span><br><span class="line">public class AliOssProprtyies &#123;</span><br><span class="line">    private String endpoint;</span><br><span class="line">    private String accessKeyId;</span><br><span class="line">    private String accessKeySecret;</span><br><span class="line">    private String bucketName;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>é…ç½®ç±»ï¼Œç”¨äºåˆ›å»ºAliOssUtilå¯¹è±¡</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">@Configuration</span><br><span class="line">public class OssConfiguration &#123;</span><br><span class="line"></span><br><span class="line">    @Bean</span><br><span class="line">    @ConditionalOnMissingBean</span><br><span class="line">    public AliOssUtil aliOssUtil(AliOssProprtyies aliOssProprtyies)&#123;</span><br><span class="line">        return  new AliOssUtil(aliOssProprtyies.getEndpoint(),</span><br><span class="line">                    aliOssProprtyies.getAccessKeyId(),</span><br><span class="line">                    aliOssProprtyies.getAccessKeySecret(),</span><br><span class="line">                aliOssProprtyies.getBucketName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>å®šä¹‰é˜¿é‡Œäº‘å·¥å…·ç±»</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line">@Data</span><br><span class="line">@AllArgsConstructor</span><br><span class="line">@Slf4j</span><br><span class="line">public class AliOssUtil &#123;</span><br><span class="line"></span><br><span class="line">    private String endpoint;</span><br><span class="line">    private String accessKeyId;</span><br><span class="line">    private String accessKeySecret;</span><br><span class="line">    private String bucketName;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * æ–‡ä»¶ä¸Šä¼ </span><br><span class="line">     *</span><br><span class="line">     * @param bytes</span><br><span class="line">     * @param objectName</span><br><span class="line">     * @return</span><br><span class="line">     */</span><br><span class="line">    public String upload(byte[] bytes, String objectName) &#123;</span><br><span class="line"></span><br><span class="line">        // åˆ›å»ºOSSClientå®ä¾‹ã€‚</span><br><span class="line">        OSS ossClient = new OSSClientBuilder().build(endpoint, accessKeyId, accessKeySecret);</span><br><span class="line"></span><br><span class="line">        try &#123;</span><br><span class="line">            // åˆ›å»ºPutObjectè¯·æ±‚ã€‚</span><br><span class="line">            ossClient.putObject(bucketName, objectName, new ByteArrayInputStream(bytes));</span><br><span class="line">        &#125; catch (OSSException oe) &#123;</span><br><span class="line">            System.out.println(&quot;Caught an OSSException, which means your request made it to OSS, &quot;</span><br><span class="line">                    + &quot;but was rejected with an error response for some reason.&quot;);</span><br><span class="line">            System.out.println(&quot;Error Message:&quot; + oe.getErrorMessage());</span><br><span class="line">            System.out.println(&quot;Error Code:&quot; + oe.getErrorCode());</span><br><span class="line">            System.out.println(&quot;Request ID:&quot; + oe.getRequestId());</span><br><span class="line">            System.out.println(&quot;Host ID:&quot; + oe.getHostId());</span><br><span class="line">        &#125; catch (ClientException ce) &#123;</span><br><span class="line">            System.out.println(&quot;Caught an ClientException, which means the client encountered &quot;</span><br><span class="line">                    + &quot;a serious internal problem while trying to communicate with OSS, &quot;</span><br><span class="line">                    + &quot;such as not being able to access the network.&quot;);</span><br><span class="line">            System.out.println(&quot;Error Message:&quot; + ce.getMessage());</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            if (ossClient != null) &#123;</span><br><span class="line">                ossClient.shutdown();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        //æ–‡ä»¶è®¿é—®è·¯å¾„è§„åˆ™ https://BucketName.Endpoint/ObjectName</span><br><span class="line">        StringBuilder stringBuilder = new StringBuilder(&quot;https://&quot;);</span><br><span class="line">        stringBuilder</span><br><span class="line">                .append(bucketName)</span><br><span class="line">                .append(&quot;.&quot;)</span><br><span class="line">                .append(endpoint)</span><br><span class="line">                .append(&quot;/&quot;)</span><br><span class="line">                .append(objectName);</span><br><span class="line"></span><br><span class="line">        log.info(&quot;æ–‡ä»¶ä¸Šä¼ åˆ°:&#123;&#125;&quot;, stringBuilder.toString());</span><br><span class="line"></span><br><span class="line">        return stringBuilder.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è‡ªå®šä¹‰ä¸Šä¼ æ¥å£</p></blockquote><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">@Autowired</span><br><span class="line">private AliOssUtil aliOssUtil;</span><br><span class="line">/**</span><br><span class="line"> * æ–‡ä»¶ä¸Šä¼ </span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">@PostMapping(&quot;upload&quot;)</span><br><span class="line">public String Upload(MultipartFile file) throws IOException &#123;</span><br><span class="line"></span><br><span class="line">    //è·å–åŸå§‹å</span><br><span class="line">    String originalFilename = file.getOriginalFilename();</span><br><span class="line">    //æˆªå– .png</span><br><span class="line">    String substring = originalFilename.substring(originalFilename.lastIndexOf(&quot;.&quot;));</span><br><span class="line">    //æ„é€ ä¸€ä¸ªæ–°åç§°</span><br><span class="line">    String filename = IdUtil.simpleUUID() + substring;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    aliOssUtil.upload(file.getBytes(), filename);</span><br><span class="line"></span><br><span class="line">    return  &quot;ä¸Šä¼ æˆåŠŸ&quot;;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><p><img src="https://s21.ax1x.com/2024/07/16/pkIhzlR.png" alt="image-20240716233536204"></p><p><img src="https://s21.ax1x.com/2024/07/16/pkI4pOx.png" alt="é˜¿é‡Œäº‘bannerå›¾"></p><p><img src="https://s21.ax1x.com/2024/07/17/pkI4XHf.png" alt="img"></p><p><img src="https://s21.ax1x.com/2024/07/17/pkI5pCQ.png" alt="SrpingBoot"></p><p><img src="https://s21.ax1x.com/2024/07/18/pkoh3jI.png" alt="ä¸‹è½½"></p>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ã€SpringBootç¯‡ã€‘é˜¿é‡Œäº‘OSS--æ–‡ä»¶å­˜å‚¨</title>
      <link href="/posts/2024/2973527110.html"/>
      <url>/posts/2024/2973527110.html</url>
      
        <content type="html"><![CDATA[<h2 id="ğŸŒ¹ä»€ä¹ˆæ˜¯é˜¿é‡Œäº‘OSS"><a href="#ğŸŒ¹ä»€ä¹ˆæ˜¯é˜¿é‡Œäº‘OSS" class="headerlink" title="ğŸŒ¹ä»€ä¹ˆæ˜¯é˜¿é‡Œäº‘OSS"></a>ğŸŒ¹ä»€ä¹ˆæ˜¯é˜¿é‡Œäº‘OSS</h2><p>é˜¿é‡Œäº‘å¯¹è±¡å­˜å‚¨ï¼ˆAlibaba Cloud Object Storage Serviceï¼Œç®€ç§°OSSï¼‰æ˜¯é˜¿é‡Œäº‘æä¾›çš„æµ·é‡ã€å®‰å…¨ã€ä½æˆæœ¬ã€é«˜å¯é çš„äº‘å­˜å‚¨æœåŠ¡ã€‚ç”¨æˆ·å¯ä»¥é€šè¿‡ç®€å•çš„APIæ¥å£åœ¨ä»»ä½•æ—¶é—´ã€ä»»ä½•åœ°ç‚¹ä¸Šä¼ å’Œä¸‹è½½æ•°æ®ï¼Œé€‚ç”¨äºå›¾åƒã€éŸ³è§†é¢‘ã€æ–‡æ¡£ã€ç½‘ç«™ç­‰å„ç§ç±»å‹çš„æ•°æ®å­˜å‚¨å’Œåˆ†å‘åœºæ™¯ã€‚</p><h2 id="â­é˜¿é‡Œäº‘OSSçš„ä¼˜ç‚¹"><a href="#â­é˜¿é‡Œäº‘OSSçš„ä¼˜ç‚¹" class="headerlink" title="â­é˜¿é‡Œäº‘OSSçš„ä¼˜ç‚¹"></a>â­é˜¿é‡Œäº‘OSSçš„ä¼˜ç‚¹</h2><p><strong>é«˜å¯é æ€§</strong>ï¼šOSSé‡‡ç”¨äº†å¤šå‰¯æœ¬å­˜å‚¨å’Œå®¹ç¾å¤‡ä»½æœºåˆ¶ï¼Œç¡®ä¿æ•°æ®çš„é«˜å¯é æ€§å’ŒæŒä¹…æ€§ã€‚<br><strong>å®‰å…¨æ€§</strong>ï¼šæ”¯æŒå¤šç§å®‰å…¨ç­–ç•¥ï¼Œå¦‚è®¿é—®æ§åˆ¶ã€åŠ å¯†ä¼ è¾“ç­‰ï¼Œä¿éšœæ•°æ®çš„å®‰å…¨æ€§ã€‚<br><strong>å¼¹æ€§æ‰©å±•</strong>ï¼šæ”¯æŒæŒ‰éœ€å­˜å‚¨å’Œå¼¹æ€§æ‰©å±•ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®å®é™…éœ€æ±‚çµæ´»è°ƒæ•´å­˜å‚¨å®¹é‡ã€‚<br><strong>ä½æˆæœ¬</strong>ï¼šOSSçš„å­˜å‚¨è´¹ç”¨ä½å»‰ï¼Œä¸”æ”¯æŒæŒ‰é‡ä»˜è´¹æ¨¡å¼ï¼Œä½¿ç”¨æˆ·èƒ½å¤Ÿæ ¹æ®å®é™…ä½¿ç”¨é‡ä»˜è´¹</p><h2 id="ğŸ³ï¸â€ğŸŒˆä¸ºä»€ä¹ˆè¦ä½¿ç”¨äº‘æœåŠ¡OSS"><a href="#ğŸ³ï¸â€ğŸŒˆä¸ºä»€ä¹ˆè¦ä½¿ç”¨äº‘æœåŠ¡OSS" class="headerlink" title="ğŸ³ï¸â€ğŸŒˆä¸ºä»€ä¹ˆè¦ä½¿ç”¨äº‘æœåŠ¡OSS"></a>ğŸ³ï¸â€ğŸŒˆä¸ºä»€ä¹ˆè¦ä½¿ç”¨äº‘æœåŠ¡OSS</h2><p>è§£å†³æœ¬åœ°å­˜å‚¨æ— æ³•ç›´æ¥è®¿é—®ï¼Œæœ¬åœ°ç£ç›˜ç©ºé—´æœ‰é™ï¼Œæœ¬åœ°ç£ç›˜æŸåè¿™3ä¸ªé—®é¢˜</p><h2 id="ğŸ„ä½¿ç”¨æ­¥éª¤"><a href="#ğŸ„ä½¿ç”¨æ­¥éª¤" class="headerlink" title="ğŸ„ä½¿ç”¨æ­¥éª¤"></a>ğŸ„ä½¿ç”¨æ­¥éª¤</h2><p><img src="https://s21.ax1x.com/2024/07/16/pkI2Fu8.png" alt="image-20240716215007220"></p><h2 id="æ–‡ä»¶ä¸Šä¼ æ“ä½œ"><a href="#æ–‡ä»¶ä¸Šä¼ æ“ä½œ" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ æ“ä½œ"></a>æ–‡ä»¶ä¸Šä¼ æ“ä½œ</h2><hr><blockquote><p>ğŸˆåœ¨pomæ–‡ä»¶ä¸­æ·»åŠ ä¸‹é¢çš„ä»£ç </p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aliyun.sdk.oss</span>&gt;</span>3.10.2<span class="tag">&lt;/<span class="name">aliyun.sdk.oss</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.aliyun.oss<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aliyun-sdk-oss<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">     <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;aliyun.sdk.oss&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"> <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>ğŸˆæœ¬åœ°å­˜å‚¨çš„è¯ åœ¨ymlä¸­å†™æ˜å­˜å‚¨åœ°æ–¹</p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">ali:</span></span><br><span class="line">  <span class="attr">spring:</span></span><br><span class="line">    <span class="attr">localhost:</span> <span class="string">D:\Program</span> <span class="string">Files\Project\Test-Project\TEST01\alioosdemo\ali-service\src\main\resources\upload</span></span><br></pre></td></tr></table></figure><blockquote><p>ğŸˆåœ¨Controllerå±‚è¿›è¡Œä¸Šä¼ æ“ä½œ</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/api/common&quot;)</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">CommonController</span> &#123;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;ali.spring.localhost&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span>  String path;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> AliOssUtil aliOssUtil;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–‡ä»¶ä¸Šä¼ </span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;upload&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">Upload</span><span class="params">(MultipartFile file)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è·å–åŸå§‹å</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">originalFilename</span> <span class="operator">=</span> file.getOriginalFilename();</span><br><span class="line">        <span class="comment">//æˆªå– .png</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">substring</span> <span class="operator">=</span> originalFilename.substring(originalFilename.lastIndexOf(<span class="string">&quot;.&quot;</span>));</span><br><span class="line">        <span class="comment">//æ„é€ ä¸€ä¸ªæ–°åç§°  ä½¿ç”¨Hutoolå·¥å…·ç±»</span></span><br><span class="line">        <span class="type">String</span> <span class="variable">filename</span> <span class="operator">=</span> IdUtil.simpleUUID() + substring;</span><br><span class="line"><span class="comment">//æ–°å»ºFileå¯¹è±¡ è¿›è¡Œå­˜å‚¨</span></span><br><span class="line">        <span class="type">File</span> <span class="variable">file1</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">File</span>(filename);</span><br><span class="line">     <span class="keyword">try</span> &#123;</span><br><span class="line">            file.transferTo(file1);</span><br><span class="line">         &#125; <span class="keyword">catch</span> (IOException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="title class_">RuntimeException</span>(e);</span><br><span class="line">         &#125;</span><br><span class="line">         <span class="keyword">return</span>  <span class="string">&quot;ä¸Šä¼ æˆåŠŸ&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="æ–‡ä»¶ä¸Šä¼ æ“ä½œï¼ˆOSSç‰ˆï¼‰"><a href="#æ–‡ä»¶ä¸Šä¼ æ“ä½œï¼ˆOSSç‰ˆï¼‰" class="headerlink" title="æ–‡ä»¶ä¸Šä¼ æ“ä½œï¼ˆOSSç‰ˆï¼‰"></a>æ–‡ä»¶ä¸Šä¼ æ“ä½œï¼ˆOSSç‰ˆï¼‰</h2><blockquote><p>ğŸˆOsså­˜å‚¨ åœ¨ymlä¸­å†™æ˜å­˜å‚¨åœ°æ–¹ <strong>access-key-id</strong>ã€ <strong>access-key-secret</strong>ã€<strong>bucket-name</strong></p></blockquote><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">ali:</span></span><br><span class="line">  <span class="attr">alioos:</span></span><br><span class="line">    <span class="attr">endpoint:</span> <span class="string">oss-cn-beijing.aliyuncs.com</span></span><br><span class="line">    <span class="attr">access-key-id:</span> <span class="string">***********</span></span><br><span class="line">    <span class="attr">access-key-secret:</span> <span class="string">***********</span></span><br><span class="line">    <span class="attr">bucket-name:</span> <span class="string">***********</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>ä½¿ç”¨@ConfigurationPropertiesæ³¨è§£è¯»å– propertiesçš„æ•°æ®</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">*</span></span><br><span class="line"><span class="comment">*<span class="doctag">@Component</span> è¡¨ç¤ºå°†è¯¥ç±»æ ‡è¯†ä¸ºBean</span></span><br><span class="line"><span class="comment">*<span class="doctag">@ConfigurationProperties</span>(prefix = &quot;ali.alioos&quot;)ç”¨äºç»‘å®šå±æ€§ï¼Œå…¶ä¸­prefixè¡¨ç¤ºæ‰€ç»‘å®šçš„å±æ€§çš„å‰ç¼€ã€‚</span></span><br><span class="line"><span class="comment">**/</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@ConfigurationProperties(prefix = &quot;ali.alioos&quot;)</span></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AliOssProprtyies</span> &#123;</span><br><span class="line">    <span class="keyword">private</span> String endpoint;</span><br><span class="line">    <span class="keyword">private</span> String accessKeyId;</span><br><span class="line">    <span class="keyword">private</span> String accessKeySecret;</span><br><span class="line">    <span class="keyword">private</span> String bucketName;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>é…ç½®ç±»ï¼Œç”¨äºåˆ›å»ºAliOssUtilå¯¹è±¡</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">OssConfiguration</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@ConditionalOnMissingBean</span></span><br><span class="line">    <span class="keyword">public</span> AliOssUtil <span class="title function_">aliOssUtil</span><span class="params">(AliOssProprtyies aliOssProprtyies)</span>&#123;</span><br><span class="line">        <span class="keyword">return</span>  <span class="keyword">new</span> <span class="title class_">AliOssUtil</span>(aliOssProprtyies.getEndpoint(),</span><br><span class="line">                    aliOssProprtyies.getAccessKeyId(),</span><br><span class="line">                    aliOssProprtyies.getAccessKeySecret(),</span><br><span class="line">                aliOssProprtyies.getBucketName());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><blockquote><p>å®šä¹‰é˜¿é‡Œäº‘å·¥å…·ç±»</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">AliOssUtil</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String endpoint;</span><br><span class="line">    <span class="keyword">private</span> String accessKeyId;</span><br><span class="line">    <span class="keyword">private</span> String accessKeySecret;</span><br><span class="line">    <span class="keyword">private</span> String bucketName;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ–‡ä»¶ä¸Šä¼ </span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> bytes</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> objectName</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> String <span class="title function_">upload</span><span class="params">(<span class="type">byte</span>[] bytes, String objectName)</span> &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// åˆ›å»ºOSSClientå®ä¾‹ã€‚</span></span><br><span class="line">        <span class="type">OSS</span> <span class="variable">ossClient</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">OSSClientBuilder</span>().build(endpoint, accessKeyId, accessKeySecret);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="comment">// åˆ›å»ºPutObjectè¯·æ±‚ã€‚</span></span><br><span class="line">            ossClient.putObject(bucketName, objectName, <span class="keyword">new</span> <span class="title class_">ByteArrayInputStream</span>(bytes));</span><br><span class="line">        &#125; <span class="keyword">catch</span> (OSSException oe) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Caught an OSSException, which means your request made it to OSS, &quot;</span></span><br><span class="line">                    + <span class="string">&quot;but was rejected with an error response for some reason.&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;Error Message:&quot;</span> + oe.getErrorMessage());</span><br><span class="line">            System.out.println(<span class="string">&quot;Error Code:&quot;</span> + oe.getErrorCode());</span><br><span class="line">            System.out.println(<span class="string">&quot;Request ID:&quot;</span> + oe.getRequestId());</span><br><span class="line">            System.out.println(<span class="string">&quot;Host ID:&quot;</span> + oe.getHostId());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (ClientException ce) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;Caught an ClientException, which means the client encountered &quot;</span></span><br><span class="line">                    + <span class="string">&quot;a serious internal problem while trying to communicate with OSS, &quot;</span></span><br><span class="line">                    + <span class="string">&quot;such as not being able to access the network.&quot;</span>);</span><br><span class="line">            System.out.println(<span class="string">&quot;Error Message:&quot;</span> + ce.getMessage());</span><br><span class="line">        &#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (ossClient != <span class="literal">null</span>) &#123;</span><br><span class="line">                ossClient.shutdown();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ–‡ä»¶è®¿é—®è·¯å¾„è§„åˆ™ https://BucketName.Endpoint/ObjectName</span></span><br><span class="line">        <span class="type">StringBuilder</span> <span class="variable">stringBuilder</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">StringBuilder</span>(<span class="string">&quot;https://&quot;</span>);</span><br><span class="line">        stringBuilder</span><br><span class="line">                .append(bucketName)</span><br><span class="line">                .append(<span class="string">&quot;.&quot;</span>)</span><br><span class="line">                .append(endpoint)</span><br><span class="line">                .append(<span class="string">&quot;/&quot;</span>)</span><br><span class="line">                .append(objectName);</span><br><span class="line"></span><br><span class="line">        log.info(<span class="string">&quot;æ–‡ä»¶ä¸Šä¼ åˆ°:&#123;&#125;&quot;</span>, stringBuilder.toString());</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> stringBuilder.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è‡ªå®šä¹‰ä¸Šä¼ æ¥å£</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> AliOssUtil aliOssUtil;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æ–‡ä»¶ä¸Šä¼ </span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@PostMapping(&quot;upload&quot;)</span></span><br><span class="line"><span class="keyword">public</span> String <span class="title function_">Upload</span><span class="params">(MultipartFile file)</span> <span class="keyword">throws</span> IOException &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//è·å–åŸå§‹å</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">originalFilename</span> <span class="operator">=</span> file.getOriginalFilename();</span><br><span class="line">    <span class="comment">//æˆªå– .png</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">substring</span> <span class="operator">=</span> originalFilename.substring(originalFilename.lastIndexOf(<span class="string">&quot;.&quot;</span>));</span><br><span class="line">    <span class="comment">//æ„é€ ä¸€ä¸ªæ–°åç§°</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">filename</span> <span class="operator">=</span> IdUtil.simpleUUID() + substring;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    aliOssUtil.upload(file.getBytes(), filename);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span>  <span class="string">&quot;ä¸Šä¼ æˆåŠŸ&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Java </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SpringBoot </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
